

## 一、简介

本文主要介绍如何使用公有云平台（阿里云、华为云、腾讯云等）提供的SLB服务配置负载上上签java服务、公网ip访问和配置域名以及https。

SLB的作用主要有以下几点：

1、负载均衡后端服务，并可以对后端服务配置负载策略和健康检查；

2、基于ip的访问白名单；

3、基于域名的负载均衡；

4、具有内网和公网ip，公网以及内网访问；

5、提供udp/tcp/http/https形式的访问协议，其中udp/tcp是四层协议，http/https是七层协议；

6、https访问协议配置ssl证书；

7、其他功能，自行到各公有云查看；



## 二、负载均衡图示

以下的ECS，各位默认安装了上上签的java服务。

#### 1、弹性负载均衡组件图

![img](混合云使用SLB.assets/zh-cn_image_0276433619.png)

#### 2、负载均衡架构图

![img](混合云使用SLB.assets/zh-cn_image_0198606126.png)





#### 3、公网负载均衡

![img](混合云使用SLB.assets/zh-cn_image_0000001135576038.png)

#### 4、私网负载均衡

![img](混合云使用SLB.assets/zh-cn_image_0000001181535567.png)

#### 5、带转发策略的负载均衡

![img](混合云使用SLB.assets/zh-cn_image_0198607873.png)

## 三、负载均衡配置：

如果客户在使用负载均衡，理论他们会自行配置。只需要告诉客户我们部署的服务的ip、port、健康检查路径，同事需要告诉客户需要一个对全网开放（如果客户仅内部，可以调整为仅内部访问和上上签访问）的https端口以及配置域名和ssl证书。



以下配置SLB流程是为了让小伙伴们有个配置流程的印象，目前是在华为云SLB配置。其他云雷同。

#### 1、购买负载均衡

![image-20211124171459726](混合云使用SLB.assets/image-20211124171459726.png)

![image-20211124172119093](混合云使用SLB.assets/image-20211124172119093.png)



#### 2、配置负载均衡

购买完成，可以在负载均衡管理页面看到负载均衡

![image-20211124172221524](混合云使用SLB.assets/image-20211124172221524.png)

之后点击进入，点击监听器，点击“添加监听器”按钮，开始配置。

![image-20211124172339099](混合云使用SLB.assets/image-20211124172339099.png)

点击添加https协议的监听器，选择证书

![image-20211124172722161](混合云使用SLB.assets/image-20211124172722161.png)

![image-20211124172818410](混合云使用SLB.assets/image-20211124172818410.png)

![image-20211124173134801](混合云使用SLB.assets/image-20211124173134801.png)



确定配置没有问题，就可以提交生效了

![image-20211124173314929](混合云使用SLB.assets/image-20211124173314929.png)

#### 3、配置后检查

配置后可以检查下相关配置

![image-20211124173458672](混合云使用SLB.assets/image-20211124173458672.png)

![image-20211124173630078](混合云使用SLB.assets/image-20211124173630078.png)

## 四、配置域名解析

根据三、3中的检查，可以看到SLB有内网和公网ip，客户服务访问，可以使用内网ip访问，外部客户（客户的客户和上上签）访问需要经过公网ip访问。
以上配置确认之后需要在域名供应商出修改域名解析，因为ssl证书对应某一个或者统配，所以此处需要注意域名和ssl证书对应的关系，**如果域名与ssl证书不符，访问会报ssl的错误。**





